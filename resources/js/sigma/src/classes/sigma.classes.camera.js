(function(p){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.classes"),sigma.classes.camera=function(t,i,s,a){sigma.classes.dispatcher.extend(this),Object.defineProperty(this,"graph",{value:i}),Object.defineProperty(this,"id",{value:t}),Object.defineProperty(this,"readPrefix",{value:"read_cam"+t+":"}),Object.defineProperty(this,"prefix",{value:"cam"+t+":"}),this.x=0,this.y=0,this.ratio=1,this.angle=0,this.isAnimated=!1,this.settings="object"==typeof a&&a?s.embedObject(a):s},sigma.classes.camera.prototype.goTo=function(t){if(!this.settings("enableCamera"))return this;var i,s,a=t||{},e=["x","y","ratio","angle"];for(i=0,s=e.length;i<s;i++)if(a[e[i]]!==p){if("number"!=typeof a[e[i]]||isNaN(a[e[i]]))throw'Value for "'+e[i]+'" is not a number.';this[e[i]]=a[e[i]]}return this.dispatchEvent("coordinatesUpdated"),this},sigma.classes.camera.prototype.applyView=function(t,i,s){s=s||{},i=i!==p?i:this.prefix,t=t!==p?t:this.readPrefix;var a,e,r,h=s.nodes||this.graph.nodes(),o=s.edges||this.graph.edges(),n=Math.cos(this.angle)/this.ratio,c=Math.sin(this.angle)/this.ratio,g=Math.pow(this.ratio,this.settings("nodesPowRatio")),l=Math.pow(this.ratio,this.settings("edgesPowRatio")),m=(s.width||0)/2-this.x*n-this.y*c,y=(s.height||0)/2-this.y*n+this.x*c;for(a=0,e=h.length;a<e;a++)(r=h[a])[i+"x"]=(r[t+"x"]||0)*n+(r[t+"y"]||0)*c+m,r[i+"y"]=(r[t+"y"]||0)*n-(r[t+"x"]||0)*c+y,r[i+"size"]=(r[t+"size"]||0)/g;for(a=0,e=o.length;a<e;a++)o[a][i+"size"]=(o[a][t+"size"]||0)/l;return this},sigma.classes.camera.prototype.graphPosition=function(t,i,s){var a=0,e=0,r=Math.cos(this.angle),h=Math.sin(this.angle);return s||(a=-(this.x*r+this.y*h)/this.ratio,e=-(this.y*r-this.x*h)/this.ratio),{x:(t*r+i*h)/this.ratio+a,y:(i*r-t*h)/this.ratio+e}},sigma.classes.camera.prototype.cameraPosition=function(t,i,s){var a=0,e=0,r=Math.cos(this.angle),h=Math.sin(this.angle);return s||(a=-(this.x*r+this.y*h)/this.ratio,e=-(this.y*r-this.x*h)/this.ratio),{x:((t-a)*r-(i-e)*h)*this.ratio,y:((i-e)*r+(t-a)*h)*this.ratio}},sigma.classes.camera.prototype.getMatrix=function(){var t=sigma.utils.matrices.scale(1/this.ratio),i=sigma.utils.matrices.rotation(this.angle),s=sigma.utils.matrices.translation(-this.x,-this.y);return sigma.utils.matrices.multiply(s,sigma.utils.matrices.multiply(i,t))},sigma.classes.camera.prototype.getRectangle=function(t,i){var s=this.cameraPosition(t,0,!0),a=this.cameraPosition(0,i,!0),e=this.cameraPosition(t/2,i/2,!0),r=this.cameraPosition(t/4,0,!0).x,h=this.cameraPosition(0,i/4,!0).y;return{x1:this.x-e.x-r,y1:this.y-e.y-h,x2:this.x-e.x+r+s.x,y2:this.y-e.y-h+s.y,height:Math.sqrt(Math.pow(a.x,2)+Math.pow(a.y+2*h,2))}}}).call(this);