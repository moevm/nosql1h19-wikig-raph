(function(u){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.misc.animation.running");var n,i=(n=0,function(){return""+ ++n});sigma.misc.animation.camera=function(a,t,n){if(!(a instanceof sigma.classes.camera&&"object"==typeof t&&t))throw"animation.camera: Wrong arguments.";if("number"!=typeof t.x&&"number"!=typeof t.y&&"number"!=typeof t.ratio&&"number"!=typeof t.angle)throw"There must be at least one valid coordinate in the given val.";var e,o,r,m,s,g=n||{},l=sigma.utils.dateNow();return s={x:a.x,y:a.y,ratio:a.ratio,angle:a.angle},g.duration,m="function"!=typeof g.easing?sigma.utils.easings[g.easing||"quadraticInOut"]:g.easing,e=function(){var n,i=g.duration?(sigma.utils.dateNow()-l)/g.duration:1;1<=i?(a.isAnimated=!1,a.goTo({x:t.x!==u?t.x:s.x,y:t.y!==u?t.y:s.y,ratio:t.ratio!==u?t.ratio:s.ratio,angle:t.angle!==u?t.angle:s.angle}),cancelAnimationFrame(o),delete sigma.misc.animation.running[o],"function"==typeof g.onComplete&&g.onComplete()):(n=m(i),a.isAnimated=!0,a.goTo({x:t.x!==u?s.x+(t.x-s.x)*n:s.x,y:t.y!==u?s.y+(t.y-s.y)*n:s.y,ratio:t.ratio!==u?s.ratio+(t.ratio-s.ratio)*n:s.ratio,angle:t.angle!==u?s.angle+(t.angle-s.angle)*n:s.angle}),"function"==typeof g.onNewFrame&&g.onNewFrame(),r.frameId=requestAnimationFrame(e))},o=i(),r={frameId:requestAnimationFrame(e),target:a,type:"camera",options:g,fn:e},sigma.misc.animation.running[o]=r,o},sigma.misc.animation.kill=function(n){if(1!==arguments.length||"number"!=typeof n)throw"animation.kill: Wrong arguments.";var i=sigma.misc.animation.running[n];return i&&(cancelAnimationFrame(n),delete sigma.misc.animation.running[i.frameId],"camera"===i.type&&(i.target.isAnimated=!1),"function"==typeof(i.options||{}).onComplete&&i.options.onComplete()),this},sigma.misc.animation.killAll=function(n){var i,a,t=0,e="string"==typeof n?n:null,o="object"==typeof n?n:null,r=sigma.misc.animation.running;for(a in r)e&&r[a].type!==e||o&&r[a].target!==o||(i=sigma.misc.animation.running[a],cancelAnimationFrame(i.frameId),delete sigma.misc.animation.running[a],"camera"===i.type&&(i.target.isAnimated=!1),t++,"function"==typeof(i.options||{}).onComplete&&i.options.onComplete());return t},sigma.misc.animation.has=function(n){var i,a="string"==typeof n?n:null,t="object"==typeof n?n:null,e=sigma.misc.animation.running;for(i in e)if(!(a&&e[i].type!==a||t&&e[i].target!==t))return!0;return!1}}).call(this);