(function(e){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.middlewares"),sigma.utils.pkg("sigma.utils"),sigma.middlewares.rescale=function(e,i,a){var t,n,s,m,d,o,g,h,x=this.graph.nodes(),r=this.graph.edges(),z=this.settings.embedObjects(a||{}),M=z("bounds")||sigma.utils.getBoundaries(this.graph,e,!0),S=M.minX,l=M.minY,f=M.maxX,u=M.maxY,c=M.sizeMax,N=M.weightMax,w=z("width")||1,E=z("height")||1,p=z("autoRescale"),y={nodePosition:1,nodeSize:1,edgeSize:1};for(p instanceof Array||(p=["nodePosition","nodeSize","edgeSize"]),t=0,n=p.length;t<n;t++)if(!y[p[t]])throw new Error('The rescale setting "'+p[t]+'" is not recognized.');var O=~p.indexOf("nodePosition"),X=~p.indexOf("nodeSize"),Y=~p.indexOf("edgeSize");for(g="outside"===z("scalingMode")?Math.max(w/Math.max(f-S,1),E/Math.max(u-l,1)):Math.min(w/Math.max(f-S,1),E/Math.max(u-l,1)),f+=h=(z("rescaleIgnoreSize")?0:(z("maxNodeSize")||c)/g)+(z("sideMargin")||0),S-=h,u+=h,l-=h,g="outside"===z("scalingMode")?Math.max(w/Math.max(f-S,1),E/Math.max(u-l,1)):Math.min(w/Math.max(f-S,1),E/Math.max(u-l,1)),m=z("maxNodeSize")||z("minNodeSize")?z("maxNodeSize")===z("minNodeSize")?(s=0,+z("maxNodeSize")):(s=(z("maxNodeSize")-z("minNodeSize"))/c,+z("minNodeSize")):(s=1,0),o=z("maxEdgeSize")||z("minEdgeSize")?(d=z("maxEdgeSize")===z("minEdgeSize")?0:(z("maxEdgeSize")-z("minEdgeSize"))/N,+z("minEdgeSize")):(d=1,0),t=0,n=r.length;t<n;t++)r[t][i+"size"]=r[t][e+"size"]*(Y?d:1)+(Y?o:0);for(t=0,n=x.length;t<n;t++)x[t][i+"size"]=x[t][e+"size"]*(X?s:1)+(X?m:0),x[t][i+"x"]=(x[t][e+"x"]-(f+S)/2)*(O?g:1),x[t][i+"y"]=(x[t][e+"y"]-(u+l)/2)*(O?g:1)},sigma.utils.getBoundaries=function(e,i,a){var t,n,s=e.edges(),m=e.nodes(),d=-1/0,o=-1/0,g=1/0,h=1/0,x=-1/0,r=-1/0;if(a)for(t=0,n=s.length;t<n;t++)d=Math.max(s[t][i+"size"],d);for(t=0,n=m.length;t<n;t++)o=Math.max(m[t][i+"size"],o),x=Math.max(m[t][i+"x"],x),g=Math.min(m[t][i+"x"],g),r=Math.max(m[t][i+"y"],r),h=Math.min(m[t][i+"y"],h);return{weightMax:d=d||1,sizeMax:o=o||1,minX:g,minY:h,maxX:x,maxY:r}}}).call(this);